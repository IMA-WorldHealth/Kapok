<!-- TODO Write templates in project standardised templating -->
<!-- TODO Remove all hardcoded account_type values -->
<head>
  
  <link rel="stylesheet" href="{{=it.path}}/templates/style/normalize.css">
  <link rel="stylesheet" href="{{=it.path}}/templates/style/skeleton.css">
  <link rel="stylesheet" href="{{=it.path}}/templates/style/reports.css">

</head>

<body>
    
  <section id="letterhead"></section>

  <section id="title" class="center" style="margin-bottom : 40px;">
      <h5>IMCK Hopital Bon Berger</h5>
      <h5>{{=it.heading}}</h5>
  
      {{? it.subheading }}
      <h6>{{=it.subheading}}</h6>
      {{?}}

  </section>
 
  <section>
  <!--span class="groupTitle">Insitution Income</span-->

    <table class="income">
      <thead>
        <tr style="border-bottom : 1px solid grey">
          <td colspan="2"></td>
          
          <!-- Repeat through column configuration --> 
          <td style="text-align : center; padding-right : 10px;">{{=it.fiscalDefinition.fiscal_year_txt}}</td>

          {{? it.comparingYears }}
          <td style="text-align : center; padding-right : 10px;">{{=it.compareDefinition.fiscal_year_txt}}</td>
          <td style="text-align : center; padding-right : 10px;">Variance</td>
          <td style="text-align : center;">(%)</td>
          {{?}}
        </tr>
      </thead>
      
      <tbody>

          <!-- TODO Use a partial definition here -->

          {{ function displayIncome(accounts) { 
               accounts.forEach(function (line, index) {
               var compare = accounts[index]; }}

        <tr class="totalRight {{? line.account_type_id === 3}}underline{{?}}">
          
          <td style="{{? line.account_type_id === 3}}font-weight : bold;{{?}}">
            {{? it.displayAccountNumber}}
            {{=line.account_number}}
            {{?}}
          </td>
          
          <td {{? line.account_type_id === 3}}colspan="8"{{?}} style="text-align : left; padding-left: {{=line.depth * 20}}px; {{? line.account_type_id === 3}}font-weight : bold;{{?}}">{{=line.account_number}} {{=line.account_txt}}</td>

          
          <!-- Repeat through column configuration - do NOT use a conditional -->
          {{? line.account_type_id !== 3}}
         
          <!-- line will be split into multiple years line.balance[year] -->
          <td style="text-align : right;">{{=line.balance || 0}}</td>
         
          {{? it.comparingYears }}
          <td style="text-align : right;">{{=line.balance || 0}}</td>

          <td style="text-align : right;">{{=line.difference || 0}}</td>
          <td style="text-align : right;">0%</td>
          {{?}}

          {{?}}

        </tr> 

      {{ if (line.children.length) displayIncome(line.children); }}
 
      {{ }); }}
      {{ } }} 

      {{ displayIncome(it.fiscal.incomeData); }}
      </tbody>
      
      <tbody>
        {{ displayIncome(it.fiscal.expenseData); }}
      </tbody>
    </table>
  </section>
</body>
